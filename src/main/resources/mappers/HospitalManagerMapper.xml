<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hospital.hospitalserver.mapper.HospitalManagerMapper">

    <select id="getManagerDetailByUsername" resultType="com.hospital.hospitalserver.domain.dto.response.GetManagerDetailByUsername">
        SELECT hmt.id,
               hmt.work_id           AS workId,
               hmt.name,
               hipt.it_profashion_title AS profashionTitle,
               hdt.name            AS departmentName,
               hmt.phone             AS phone
        FROM hospital.h_manager_tb hmt
                 LEFT JOIN hospital.h_it_profashion_title_tb hipt ON hipt.id = hmt.mpt_id
                 LEFT JOIN hospital.h_clinic_room_manager_tb hcrmt ON hmt.id = hcrmt.manager_id
                 LEFT JOIN hospital.h_clinic_room_tb hcrt ON hcrmt.clinic_room_id = hcrt.id
                 LEFT JOIN hospital.h_department_tb hdt ON hdt.id = hcrt.department_id
                 LEFT JOIN hospital.h_user_tb u ON u.id = hmt.id
                 LEFT JOIN hospital.h_role_tb r ON u.role_id = r.id
        WHERE u.username = #{username}
            LIMIT 1
    </select>
</mapper>