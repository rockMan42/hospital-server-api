<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hospital.hospitalserver.mapper.HospitalNurseMapper">

    <select id="getNurseDetailByUsername" resultType="com.hospital.hospitalserver.domain.dto.response.GetNurseDetailByUsername">
        SELECT hnt.id,
               hnt.work_id           AS workId,
               hnt.name              AS name,
               hntp.nurse_profashion_title AS profashionTitle,
               hdt.name            AS departmentName,
               hnt.major_direct      AS majorDirect,
               hnt.phone             AS phone,
               hnt.enter_date        AS enterDate,
               hnt.status            AS status,
               hnt.gender            AS gender,
               hnt.age               AS age,
               hnt.description       AS description
        FROM hospital.h_nurse_tb hnt
                 LEFT JOIN hospital.h_nurse_profashion_title_tb hntp ON hntp.id = hnt.npt_id
                 LEFT JOIN hospital.h_clinic_room_nurse_tb hcrnt ON hnt.id = hcrnt.nurse_id
                 LEFT JOIN hospital.h_clinic_room_tb hcrt ON hcrnt.clinic_room_id = hcrt.id
                 LEFT JOIN hospital.h_department_tb hdt ON hdt.id = hcrt.department_id
                 LEFT JOIN hospital.h_user_tb u ON u.id = hnt.id
                 LEFT JOIN hospital.h_role_tb r ON u.role_id = r.id
        WHERE u.username = #{username}
            LIMIT 1
    </select>
</mapper>